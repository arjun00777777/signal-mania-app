<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SignalMania Ecosystem</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-color: #050505; /* Hacker Black */
            --card-bg: #111;
            --text-primary: #00ff41; /* Matrix Green */
            --text-secondary: #a8b2d1;
            --accent: #00ff41;
            --danger: #ff003c;
            --nav-bg: #0a0a0a;
        }
        body {
            background-color: var(--bg-color);
            color: var(--text-primary);
            font-family: 'Courier New', monospace;
            margin: 0;
            padding: 0;
            padding-bottom: 90px;
        }
        .container { max-width: 500px; margin: 0 auto; padding: 20px; }
        
        /* GLITCH HEADER */
        h1 { 
            font-size: 28px; 
            text-transform: uppercase; 
            letter-spacing: 3px; 
            text-shadow: 0 0 10px var(--accent);
            margin-bottom: 10px;
        }
        p { color: var(--text-secondary); margin-top: 0; font-size: 14px; }

        /* CYBERPUNK CARDS */
        .card {
            background-color: var(--card-bg);
            border: 1px solid #333;
            border-left: 3px solid var(--accent);
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 0 15px rgba(0, 255, 65, 0.1);
        }

        /* INPUTS & BUTTONS */
        .input-group { display: flex; gap: 10px; margin-bottom: 15px; }
        input, select {
            background: #000; border: 1px solid #333; color: var(--accent);
            padding: 12px; font-family: inherit; width: 100%;
        }
        button {
            background-color: var(--accent); color: black; border: none; padding: 14px;
            font-weight: 900; letter-spacing: 1px; cursor: pointer; text-transform: uppercase;
        }
        button:active { transform: scale(0.98); }
        
        /* üõ£Ô∏è ROADMAP STYLES */
        .roadmap { margin-top: 20px; position: relative; padding-left: 20px; }
        .roadmap::before {
            content: ''; position: absolute; left: 0; top: 0; bottom: 0;
            width: 2px; background: #333;
        }
        .phase { position: relative; margin-bottom: 30px; padding-left: 20px; }
        .phase::before {
            content: ''; position: absolute; left: -26px; top: 5px;
            width: 14px; height: 14px; background: #000;
            border: 2px solid var(--text-secondary); border-radius: 50%;
        }
        .phase.active::before {
            background: var(--accent); border-color: var(--accent);
            box-shadow: 0 0 10px var(--accent);
        }
        .phase-title { color: white; font-weight: bold; font-size: 16px; margin-bottom: 5px; }
        .phase-desc { color: var(--text-secondary); font-size: 13px; line-height: 1.4; }

        /* MINING CIRCLE */
        .hacker-screen { text-align: center; padding: 30px 0; }
        .score-circle {
            width: 180px; height: 180px;
            background: radial-gradient(circle, #111 0%, #000 70%);
            border: 2px dashed var(--accent);
            border-radius: 50%;
            margin: 0 auto 20px auto;
            display: flex; flex-direction: column; justify-content: center;
            box-shadow: 0 0 25px rgba(0, 255, 65, 0.2);
            transition: transform 0.1s;
        }
        .score-circle:active { transform: scale(0.95); }
        .score-val { font-size: 40px; color: var(--accent); font-weight: bold; }

        /* NAVIGATION */
        .bottom-nav {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background-color: var(--nav-bg);
            display: flex; justify-content: space-around;
            padding: 15px 0;
            border-top: 1px solid #333;
            z-index: 1000;
        }
        .nav-item { opacity: 0.5; text-align: center; font-size: 11px; cursor: pointer; flex: 1; }
        .nav-item.active { opacity: 1; color: var(--accent); text-shadow: 0 0 8px var(--accent); }
        .nav-icon { font-size: 22px; display: block; margin-bottom: 5px; }

        /* UTILS */
        .tab-content { display: none; animation: fadeIn 0.3s; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity:0; } to { opacity:1; } }
        .signal-item { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px dashed #333; }
    </style>
</head>
<body>

<div id="tab-signals" class="container tab-content active">
    <h1>Signal<span style="color:white">Mania</span></h1>
    <p>Network Status: <span style="color:var(--accent)">CONNECTED</span></p>

    <div class="card">
        <h3 style="margin-top:0">üì° Active Protocols</h3>
        <div id="alerts-list">
            <p style="text-align:center; opacity:0.5">No active watchers.</p>
        </div>
    </div>

    <div class="card">
        <h3 style="margin-top:0">‚ûï Deploy Watcher</h3>
        <div class="input-group">
            <input type="text" id="alert-coin" placeholder="ASSET (e.g. BTC)">
            <select id="alert-condition" style="max-width: 80px;">
                <option value="ABOVE">></option>
                <option value="BELOW"><</option>
            </select>
        </div>
        <div class="input-group">
            <input type="number" id="alert-price" placeholder="TARGET PRICE">
        </div>
        <button onclick="setAlert()">INITIALIZE</button>
        <p id="alert-msg" style="margin-top:10px; font-size:12px;"></p>
    </div>

    <div class="card">
        <h3 style="margin-top:0">üê≥ Whale Radar</h3>
        <div id="signals-list">
            <p style="text-align:center; opacity:0.5">Intercepting data...</p>
        </div>
    </div>
</div>

<div id="tab-mining" class="container tab-content">
    <h1>Crypto<span style="color:white">Hacker</span></h1>
    <p>System Breach in Progress...</p>
    
    <div class="hacker-screen">
        <div class="score-circle" onclick="minePoint()">
            <span class="score-val" id="user-points">0</span>
            <span style="font-size:10px; letter-spacing:2px">HASHES</span>
        </div>
        <div style="margin-bottom:20px; font-size:12px; color:#555;">
            [////////////////////] 100% ENERGY
        </div>
        <button style="background:#111; border:1px solid var(--accent); color:var(--accent)">
            UPGRADE RIG (COMING SOON)
        </button>
    </div>
</div>

<div id="tab-tasks" class="container tab-content">
    <h1>Master<span style="color:white">Plan</span></h1>
    <p>The Path to Domination</p>
    
    <div class="roadmap">
        <div class="phase active">
            <div class="phase-title">PHASE 1: THE AWAKENING</div>
            <div class="phase-desc">
                ‚úÖ Launch SignalMania (Utility)<br>
                ‚úÖ Launch CryptoHacker (Miner)<br>
                üîÑ Mining System Live
            </div>
        </div>
        <div class="phase">
            <div class="phase-title">PHASE 2: EXPANSION (TBA)</div>
            <div class="phase-desc">
                ‚¨ú Squad System (Team Mining)<br>
                ‚¨ú Weekly USDT Leaderboards<br>
                ‚¨ú AI Signal Prediction Model
            </div>
        </div>
        <div class="phase">
            <div class="phase-title">PHASE 3: TOKEN GEN (TBA)</div>
            <div class="phase-desc">
                ‚¨ú $MANIA Token Launch (TGE)<br>
                ‚¨ú Community Airdrop (Convert Points)<br>
                ‚¨ú NFT Rig Marketplace
            </div>
        </div>
        <div class="phase">
            <div class="phase-title">PHASE 4: TAKEOVER (TBA)</div>
            <div class="phase-desc">
                ‚¨ú Tier-1 CEX Listing<br>
                ‚¨ú Automated Trading Bot
            </div>
        </div>
    </div>

    <div class="card" style="margin-top:30px">
        <h3 style="margin-top:0">üèÜ Daily Missions</h3>
        <div class="signal-item">
            <div><strong>Join Telegram Channel</strong><br><span style="font-size:10px; color:var(--text-secondary)">+500 HASHES</span></div>
            <button style="width:auto; padding:5px 10px; font-size:12px">GO</button>
        </div>
    </div>
</div>

<div class="bottom-nav">
    <div class="nav-item active" onclick="switchTab('signals', this)">
        <span class="nav-icon">üì°</span> SIGNALS
    </div>
    <div class="nav-item" onclick="switchTab('mining', this)">
        <span class="nav-icon">üë®‚Äçüíª</span> MINING
    </div>
    <div class="nav-item" onclick="switchTab('tasks', this)">
        <span class="nav-icon">üó∫Ô∏è</span> ROADMAP
    </div>
</div>

<script>
    // ‚ö†Ô∏è REPLACE WITH YOUR DOMAIN WHEN READY
    // const API_BASE_URL = "https://api.signalmania.com";
    const API_BASE_URL = "https://claustral-mable-dissectible.ngrok-free.dev -> http://localhost:5000"; 

    const tg = window.Telegram.WebApp;
    tg.expand(); 
    tg.MainButton.hide();

    // === NAVIGATION ===
    function switchTab(tabId, navElement) {
        document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
        document.getElementById('tab-' + tabId).classList.add('active');
        navElement.classList.add('active');
    }

    // === MINING (LOCAL MOCKUP) ===
    let points = localStorage.getItem('mining_points') ? parseInt(localStorage.getItem('mining_points')) : 0;
    document.getElementById('user-points').innerText = points;

    function minePoint() {
        points += 1; // Simple increment
        document.getElementById('user-points').innerText = points;
        localStorage.setItem('mining_points', points); // Save locally
        tg.HapticFeedback.impactOccurred('medium'); // Vibrate phone
    }

    // === API CONNECTIONS (SIGNALS) ===
    async function loadAlerts() {
        try {
            const response = await fetch(`${API_BASE_URL}/alert/list`, {
                method: "POST", headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ initData: tg.initData })
            });
            const alerts = await response.json();
            const list = document.getElementById("alerts-list");
            list.innerHTML = "";
            if (alerts.length === 0) list.innerHTML = "<p style='text-align:center; opacity:0.5'>No active watchers.</p>";
            alerts.forEach(alert => {
                const div = document.createElement("div");
                div.className = "signal-item";
                div.innerHTML = `<div><strong style="color:white">${alert.symbol}</strong> ${alert.condition === 'ABOVE' ? 'Above' : 'Below'} <span style="color:var(--accent)">$${alert.price}</span></div><button style="background:none; color:var(--danger); width:auto;" onclick="deleteAlert(${alert.id})">‚úñ</button>`;
                list.appendChild(div);
            });
        } catch (e) { console.log("Offline Mode or Error"); }
    }

    async function setAlert() {
        const coin = document.getElementById("alert-coin").value;
        const price = document.getElementById("alert-price").value;
        const condition = document.getElementById("alert-condition").value;
        const msgEl = document.getElementById("alert-msg");
        
        try {
            const response = await fetch(`${API_BASE_URL}/alert/create`, {
                method: "POST", headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ initData: tg.initData, symbol: coin, price: price, condition: condition })
            });
            const data = await response.json();
            if(data.status === "success") {
                msgEl.innerText = "‚úÖ WATCHER INITIALIZED"; msgEl.style.color = "var(--accent)"; loadAlerts();
            } else { msgEl.innerText = "‚ùå " + data.message; msgEl.style.color = "var(--danger)"; }
        } catch (e) { msgEl.innerText = "‚ùå CONNECTION FAILED"; msgEl.style.color = "var(--danger)"; }
    }

    async function deleteAlert(id) {
        if(!confirm("TERMINATE PROTOCOL?")) return;
        await fetch(`${API_BASE_URL}/alert/delete`, {
            method: "POST", headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ initData: tg.initData, alert_id: id })
        });
        loadAlerts();
    }

    async function loadSignals() {
        try {
            const response = await fetch(`${API_BASE_URL}/market/signals`);
            const signals = await response.json();
            const list = document.getElementById("signals-list");
            list.innerHTML = "";
            if (signals.length === 0) list.innerHTML = "<p style='text-align:center; opacity:0.5'>Scanning blockchain...</p>";
            signals.forEach(sig => {
                const color = sig.direction === "LONG" ? "var(--accent)" : "var(--danger)";
                const arrow = sig.direction === "LONG" ? "‚ñ≤" : "‚ñº";
                const div = document.createElement("div");
                div.className = "signal-item";
                div.innerHTML = `<div><strong>${sig.symbol}</strong><div style="font-size:10px; opacity:0.7">$${sig.entry}</div></div><div style="color:${color}; font-weight:bold;">${arrow} ${sig.direction}</div>`;
                list.appendChild(div);
            });
        } catch (e) { console.log("Offline Mode"); }
    }

    // Init
    loadAlerts();
    loadSignals();
    setInterval(loadSignals, 30000);
</script>

</body>
</html>
